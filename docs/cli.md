# ğŸ§  CLI

A CLI (generated using [bashly](https://bashly.dannyb.co/)) is available in `scripts/cli/playground`.

## ğŸšœ Setup

### ğŸ¦¶ Setup PATH

Add it to your `PATH` environment variable by adding this in your `~/.bashrc` or `~/.zshrc`:

```bash
export PATH=/path/to/kafka-docker-playground/scripts/cli:$PATH
```

> [!WARNING]
> The bash scripts generated by [bashly](https://bashly.dannyb.co/) can run in any shell, but require that bash 4 or higher is installed.
> Mac users can upgrade bash by running `brew install bash`

### âš¡ Setup completion

A Bash completion file is also available in `scripts/cli/completions.bash`.

In order to be able to use completion with the CLI, you just need to add this in your `~/.bashrc` or `~/.zshrc`:

```bash
source /path/to/kafka-docker-playground/scripts/cli/completions.bash
```

> [!NOTE]
> If you use ZSH, but **not** `Oh-My-Zsh`, please check [this](https://bashly.dannyb.co/advanced/bash-completion/#completions-in-zsh).

### âš™ï¸ Config file 

CLI can be configured using `config.ini` [file](https://github.com/vdesabou/kafka-docker-playground/blob/master/scripts/cli/config.ini)

```ini
;; Configuration file for playground CLI

;; You can configure the path to your config.ini file using CONFIG_FILE environment variable
;; export CONFIG_FILE="path/to/config.ini"

; editor to use to open files
editor = code

; list (comma separated) of folders where to search for zip or jar
; Current folder is always included
; examples:
; folder_zip_or_jar = ~/Downloads,~/Documents/github/kafka-connect-*
folder_zip_or_jar = ~/Downloads

; list (comma separated) of folders where to search for schema files (*.avsc, *.json, *.proto, *.proto3)
; Current folder is always included
; examples:
; folder_producer_schema = ~/Downloads,~/Documents/github/kafka-connect-*
folder_producer_schema = ~/Downloads
```

You can configure the path to your own config.ini file using `CONFIG_FILE` environment variable:

```bash
export CONFIG_FILE="path/to/config.ini"
```

## ğŸš€ Run commands

### ğŸ•¹ï¸ `run`

Run any example from anywhere using all the possible options available !


> [!WARNING]
> The `run` command requires to have [fzf](https://github.com/junegunn/fzf) installed, it can easily be installed with `brew install fzf` on Mac.

> [!TIP]
> [bat](https://github.com/sharkdp/bat) is also used by `run` command to display files with syntax highlighting and colors, you can install it using `brew install bat` on Mac.

#### ğŸ¿ Example

<script async id="asciicast-581275" src="https://asciinema.org/a/581275.js" async data-autoplay="true" data-size="big"></script>

#### ğŸ§‘â€ğŸ“ Usage

```bash
playground run --help
playground run

  ğŸ•¹ï¸ Run any example
  
  ğŸ‘‰ Check documentation https://tinyurl.com/xxx

== Usage ==
  playground run [OPTIONS] [ARGUMENTS...]
  playground run --help | -h

== Options ==
  --file, -f FILE (required)
    ğŸ”– Example file to run
    
    It must be absolute full path
    
    ğŸ“ Tip: use <tab> completion to trigger fzf completion

  --open, -o
    ğŸ“– Opening example file with text editor set with config.ini (default is
    code)

  --tag TAG
    ğŸ¯ Confluent Platform (CP) version to use
    
    Must be greater or equal to 5.0.0

  --connector-tag CONNECTOR_TAG
    ğŸ”— Connector version to use
    
    By default, for each connector, the latest available version on Confluent
    Hub is used

  --connector-zip CONNECTOR_ZIP
    ğŸ¤ Connector zip to use
    
    It must be absolute full path
    
    ğŸ“ Tip: use <tab> completion to trigger fzf completion 
            use folder_zip_or_jar (default: ~/Downloads) in config.ini file to
    configure where to search the files (current folder is always used)

  --connector-jar CONNECTOR_JAR
    â™¨ï¸ Connector jar to use
    
    It must be absolute full path
    
    ğŸ“ Tip: use <tab> completion to trigger fzf completion 
            use folder_zip_or_jar (default: ~/Downloads) in config.ini file to
    configure where to search the files (current folder is always used)

  --disable-ksqldb
    ğŸ›‘ Disable ksqlDB
    
    By default, ksqldb-server and ksqldb-cli containers are started for every
    test

  --disable-control-center
    ğŸ›‘ Disable Control Center
    
    By default, control-center container is started for every test
    
    Control Center is reachable at http://127.0.0.1:9021

  --enable-conduktor
    ğŸº Enable Conduktor Platform
    
    By default, Conduktor Platform container is not started for every test
    
    Conduktor is reachable at http://127.0.0.1:8080/console (admin/admin)

  --enable-multiple-brokers
    3ï¸âƒ£ Enable multiple brokers
    
    By default, there is only one broker node enabled

  --enable-multiple-connect-workers
    ğŸ¥‰ Enable multiple connect node
    
    By default, there is only one connect node enabled
    
    It only works when plaintext environment is used

  --enable-jmx-grafana
    Enable Grafana, Prometheus and Pyroscope
    
    ğŸ“Š Grafana is reachable at http://127.0.0.1:3000
    ğŸ›¡ï¸ Prometheus is reachable at http://127.0.0.1:9090
    ğŸ“› Pyroscope is reachable at http://127.0.0.1:4040

  --enable-kcat
    ğŸˆâ€â¬› Enable kcat
    
    You can use it with:
    
    $ docker exec kcat kcat -b broker:9092 -L

  --enable-sr-maven-plugin-app
    ğŸ”° Enable Schema Registry Maven plugin App

  --enable-sql-datagen
    ğŸŒªï¸ Enable SQL Datagen injection
    
    This only works for Oracle, MySql, Postgres and Microsoft Sql Server source
    connector examples with JDBC and Debezium

  --help, -h
    Show this help

== Arguments ==
  ARGUMENTS...
    Arguments to use by example script
```

### âš¡ `re-run`

Simply re-run last example you ran with `run` [command](/cli?id=%f0%9f%95%b9%ef%b8%8f-run) !

If you don't specify any flags, it will re-run with same flags as before.

Examples:

```bash
$ playground re-run

# will re-run same example:
$ playground run -f /path/to/kafka-docker-playground/connect/connect-jdbc-postgresql-sink/postgres-sink.sh --tag=7.3.3 --connector-tag=10.6.0 --disable-control-center
```

```bash
$ playground re-run --connector-tag=10.6.1

# will re-run same example but replace previous flags with:
$ playground run -f /path/to/kafka-docker-playground/connect/connect-jdbc-postgresql-sink/postgres-sink.sh --connector-tag=10.6.1
```

#### ğŸ¿ Example

<script async id="asciicast-581276" src="https://asciinema.org/a/581276.js"></script>

#### ğŸ§‘â€ğŸ“ Usage

```bash
playground re-run --help
playground re-run - âš¡ Simply re-run last example you ran with <playground run>

== Usage ==
  playground re-run [OPTIONS] [ARGUMENTS...]
  playground re-run --help | -h

== Options ==
  --tag TAG
    ğŸ¯ Confluent Platform (CP) version to use
    
    Must be greater or equal to 5.0.0

  --connector-tag CONNECTOR_TAG
    ğŸ”— Connector version to use
    
    By default, for each connector, the latest available version on Confluent
    Hub is used

  --connector-zip CONNECTOR_ZIP
    ğŸ¤ Connector zip to use
    
    It must be absolute full path
    
    ğŸ“ Tip: use <tab> completion to trigger fzf completion 
            use folder_zip_or_jar (default: ~/Downloads) in config.ini file to
    configure where to search the files (current folder is always used)

  --connector-jar CONNECTOR_JAR
    â™¨ï¸ Connector jar to use
    
    It must be absolute full path
    
    ğŸ“ Tip: use <tab> completion to trigger fzf completion 
            use folder_zip_or_jar (default: ~/Downloads) in config.ini file to
    configure where to search the files (current folder is always used)

  --disable-ksqldb
    ğŸ›‘ Disable ksqlDB
    
    By default, ksqldb-server and ksqldb-cli containers are started for every
    test

  --disable-control-center
    ğŸ›‘ Disable Control Center
    
    By default, control-center container is started for every test
    
    Control Center is reachable at http://127.0.0.1:9021

  --enable-conduktor
    ğŸº Enable Conduktor Platform
    
    By default, Conduktor Platform container is not started for every test
    
    Conduktor is reachable at http://127.0.0.1:8080/console (admin/admin)

  --enable-multiple-brokers
    3ï¸âƒ£ Enable multiple brokers
    
    By default, there is only one broker node enabled

  --enable-multiple-connect-workers
    ğŸ¥‰ Enable multiple connect node
    
    By default, there is only one connect node enabled
    
    It only works when plaintext environment is used

  --enable-jmx-grafana
    Enable Grafana, Prometheus and Pyroscope
    
    ğŸ“Š Grafana is reachable at http://127.0.0.1:3000
    ğŸ›¡ï¸ Prometheus is reachable at http://127.0.0.1:9090
    ğŸ“› Pyroscope is reachable at http://127.0.0.1:4040

  --enable-kcat
    ğŸˆâ€â¬› Enable kcat
    
    You can use it with:
    
    $ docker exec kcat kcat -b broker:9092 -L

  --enable-sr-maven-plugin-app
    ğŸ”° Enable Schema Registry Maven plugin App

  --enable-sql-datagen
    ğŸŒªï¸ Enable SQL Datagen injection
    
    This only works for Oracle, MySql, Postgres and Microsoft Sql Server source
    connector examples with JDBC and Debezium

  --help, -h
    Show this help

== Arguments ==
  ARGUMENTS...
    Arguments to use by example script
```

### ğŸ‘ `open`

Simply open last example you ran with `run` [command](/cli?id=%f0%9f%95%b9%ef%b8%8f-run) in your configured editor (see `editor` config in [âš™ï¸ Config file](/cli?id=%e2%9a%99%ef%b8%8f-config-file), default is code).

#### ğŸ¿ Example

<script async id="asciicast-581277" src="https://asciinema.org/a/581277.js"></script>

#### ğŸ§‘â€ğŸ“ Usage

```bash
playground open --help
playground open - ğŸ‘ Simply open last example you ran with <playground run>

== Usage ==
  playground open
  playground open --help | -h

== Options ==
  --help, -h
    Show this help

```

## ğŸ”— Connector commands

Easily interact with running connectors.

### ğŸ§© `status`

Show status of all connectors

<script async id="asciicast-581278" src="https://asciinema.org/a/581278.js"></script>

### ğŸ¨ `plugins`

Show all plugins installed

<script async id="asciicast-581279" src="https://asciinema.org/a/581279.js"></script>

### â¸ï¸ `pause`

Pause connector

<script async id="asciicast-581280" src="https://asciinema.org/a/581280.js"></script>

> [!TIP]
> If flag `--connector` (`-c`) is not specified, the command will apply to all connectors.

### â¯ï¸ `resume`

Resume connector

<script async id="asciicast-581281" src="https://asciinema.org/a/581281.js"></script>

> [!TIP]
> If flag `--connector` (`-c`) is not specified, the command will apply to all connectors.

### ğŸ§ `versions`

Get current version used in example

<script async id="asciicast-581282" src="https://asciinema.org/a/581282.js"></script>

> [!TIP]
> If flag `--connector` (`-c`) is not specified, the command will apply to all connectors.

### â™»ï¸ `restart`

Restart connector(s)

<script async id="asciicast-581284" src="https://asciinema.org/a/581284.js"></script>

> [!TIP]
> If flag `--connector` (`-c`) is not specified, the command will apply to all connectors.

### ğŸ—‘ï¸ `delete`

Delete connector

<script async id="asciicast-581288" src="https://asciinema.org/a/581288.js"></script>

> [!TIP]
> If flag `--connector` (`-c`) is not specified, the command will apply to all connectors.

### ğŸ¢ `show-lag`

Show lag of sink connector

<script async id="asciicast-581285" src="https://asciinema.org/a/581285.js"></script>

> [!TIP]
> If flag `--connector` (`-c`) is not specified, the command will apply to all connectors.

### ğŸ§¬ `log-level`

Set connect log level

<script async id="asciicast-581287" src="https://asciinema.org/a/581287.js"></script>

> [!TIP]
> If flag `--connector` (`-c`) is not specified, the command will apply to all connectors.

## ğŸ“¦ Container commands

Easily interact with running docker containers.

### ğŸ’« `recreate`

Recreate container(s)

### ğŸ–¥ï¸ `get-ip-addresses`

Get ip address of running containers

<script async id="asciicast-581364" src="https://asciinema.org/a/581364.js"></script>

### ğŸ•µï¸ `logs`

Tail and follow container logs

### ğŸ›¬ `ssh`

SSH into container

<script async id="asciicast-581366" src="https://asciinema.org/a/581366.js"></script>

```bash
$ playground container ssh --help
playground container ssh - ğŸ›¬ SSH into container

== Usage ==
  playground container ssh [OPTIONS]
  playground container ssh --help | -h

== Options ==
  --container, -c CONTAINER
    ğŸ³ Container name
    Default: connect

  --shell, -s SHELL
    ğŸ’¾ Shell to use (default is bash)
    Allowed: bash, sh, ksh, zsh
    Default: bash

  --help, -h
    Show this help

Examples
  playground ssh -c connect
  playground ssh -c connect -s sh
  playground ssh --container connect --shell sh
```

> [!TIP]
> If flag `--container` (`-c`) is not specified, the command will apply to `connect` container.

### ğŸª„ `exec`

Execute command in a container

<script async id="asciicast-581367" src="https://asciinema.org/a/581367.js"></script>

```bash
$ playground container exec --help                                        
playground container exec - ğŸª„  Execute command in a container

== Usage ==
  playground container exec [OPTIONS]
  playground container exec --help | -h

== Options ==
  --container, -c CONTAINER
    ğŸ³ Container name
    Default: connect

  --command COMMAND (required)
    ğŸ“² Command to execute

  --root
    ğŸ‘‘ Run command as root

  --shell SHELL
    ğŸ’¾ Shell to use (default is bash)
    Allowed: bash, sh, ksh, zsh
    Default: bash

  --help, -h
    Show this help

Examples
  playground exec -c connect -d "date"
  playground exec -c connect -d "whoami" --root
  playground exec --container connect --command "whoami" --shell sh
```

> [!TIP]
> If flag `--container` (`-c`) is not specified, the command will apply to `connect` container.

### ğŸ” `restart`

Restart a container

<script async id="asciicast-581368" src="https://asciinema.org/a/581368.js"></script>

### â¸ï¸ `pause`

Pause a container

<script async id="asciicast-581369" src="https://asciinema.org/a/581369.js"></script>

### â¯ï¸ `resume`

Resume a container

<script async id="asciicast-581584" src="https://asciinema.org/a/581584.js"></script>

### ğŸ”« `kill`

Kill a container

<script async id="asciicast-581586" src="https://asciinema.org/a/581586.js"></script>

### ğŸ’€ `kill-all`

Kill all containers

<script async id="asciicast-581587" src="https://asciinema.org/a/581587.js"></script>

## ğŸ—³ Topics commands

Easily interact with kafka topics.

### ğŸ’« `recreate`

# ğŸ’¯ `get-number-records`         

Get number of records in a topic

# ğŸ“¬ `display-connect-offsets`

Display content of connect offsets topic
# ğŸ“­ `display-consumer-offsets`

Display content of __consumer_offsets topic

# ğŸ”¬ `describe`

ğŸ”¬ Describe topic

# ğŸ“¥ `consume`

Consume topic(s) from current running examples